utils.jq((()=>{const e=document.querySelector(".ds-twikoo");utils.onLoading(e);const t=e.getAttribute("api"),a=parseInt(e.getAttribute("limit"))||10,i="reply"!==e.getAttribute("hide");t&&fetch(t,{method:"POST",body:JSON.stringify({event:"GET_RECENT_COMMENTS",envId:t,pageSize:a,includeReply:i}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((({data:t})=>{utils.onLoadSuccess(e),t.forEach(((t,a)=>{let i=t.commentText;if(i&&""!==i.trim()){i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),i=i.length>50?i.substring(0,50)+"...":i;var n='<div class="timenode" index="'+a+'">';n+='<div class="header">',n+='<div class="user-info">',n+="<span>"+t.nick+"</span>",n+="</div>",n+="<span>"+new Date(t.created).toLocaleString()+"</span>",n+="</div>",n+='<a class="body" href="'+t.url+"#"+t.id+'">',n+=i,n+="</a>",n+="</div>",$(e).append(n)}}))})).catch((()=>utils.onLoadFailure(e)))}));