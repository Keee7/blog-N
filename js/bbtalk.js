let jsonUrl="https://kkapi.cqlkc.top/api/ispeak?author=633aaa45d0d52c818b1cf9c1&page=1";const el=document.querySelector("#bber-talk");function bbtalk(){utils.onLoading(el);let e,t=JSON.parse(localStorage.getItem("bibi")),a=Date.now();if(null==t||a-t.time>=18e5)return void getData();e=JSON.parse(t.ls);let i="";utils.onLoadSuccess(el),e.forEach(((e,t)=>{if(t>=5)return;e.content=e.content.replace(/[\s\uFEFF\xA0]+/g,""),i+='<div class="item timenode" index="'+t+'">',i+='<div class="header">',i+='<div class="user-info">',i+="<span>cqlkc</span>",i+="</div>",i+="<span>"+new Date(e.createdAt).toLocaleString("zh-CN",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})+"</span>",i+="</div>",i+='<a class="body" href="/bbtalk/">',i+=e.content,i+="</a>",i+="</div>"})),document.getElementById("bber-talk").innerHTML+='<i style="margin-right: 10px;" class="fa-regular fa-message"></i><div class="tag-plugin timeline" api>'+i+'</div><i class="fa-solid fa-angles-right pass bber-icon"></i>'}function getData(){fetch(jsonUrl).then((e=>e.json())).then((e=>{e={time:Date.now(),ls:JSON.stringify(e.data.items)},localStorage.setItem("bibi",JSON.stringify(e))})).then((()=>{bbtalk()})).catch((()=>{console.log("获取哔哔数据失败！")}))}function urlToLink(e){return e=e.replace(/<img(.*?)src=[\"|\']?(.*?)[\"|\']?(.*?)>|!\[(.*?)\]\((.*?)\)/g,'<i class="fa-solid fa-image"></i>')}document.getElementById("bber-talk").addEventListener("click",(()=>{pjax.loadUrl("/bbtalk/")})),bbtalk(),document.addEventListener("pjax:complete",(()=>{bbtalk()}));